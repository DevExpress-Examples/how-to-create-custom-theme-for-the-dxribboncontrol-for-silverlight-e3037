<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:dxt="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys" xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars" xmlns:dxbt="http://schemas.devexpress.com/winfx/2008/xaml/bars/themekeys" xmlns:dxbc="http://schemas.devexpress.com/winfx/2008/xaml/bars/internal" xmlns:dxdst="http://schemas.devexpress.com/winfx/2008/xaml/core/themekeys">
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/DevExpress.Xpf.Themes.CustomTheme.v10.2;component/DevExpress.Xpf.Core/DevExpress.Xpf.Core/Bars/Themes/CustomTheme/BarItems.xaml" />
        <ResourceDictionary Source="/DevExpress.Xpf.Themes.CustomTheme.v10.2;component/DevExpress.Xpf.Core/DevExpress.Xpf.Core/Bars/Themes/CustomTheme/BarSubItem.xaml" />
        <ResourceDictionary Source="/DevExpress.Xpf.Themes.CustomTheme.v10.2;component/DevExpress.Xpf.Core/DevExpress.Xpf.Core/Bars/Themes/CustomTheme/BarButtonItem.xaml" />
        <ResourceDictionary Source="/DevExpress.Xpf.Themes.CustomTheme.v10.2;component/DevExpress.Xpf.Core/DevExpress.Xpf.Core/Bars/Themes/CustomTheme/BarSplitButtonItem.xaml" />
        <ResourceDictionary Source="/DevExpress.Xpf.Themes.CustomTheme.v10.2;component/DevExpress.Xpf.Core/DevExpress.Xpf.Core/Bars/Themes/CustomTheme/BarEditItem.xaml" />
    </ResourceDictionary.MergedDictionaries>


    <dxc:BooleanToVisibilityConverter x:Key="notInvertedBooleanToVisibilityConverter" Invert="False" />
    <dxc:BooleanToVisibilityConverter x:Key="invertedBooleanToVisibilityConverter" Invert="True" />

    <sys:Double x:Key="BarItemThemeKey_DisableStateOpacityValue">0.35</sys:Double>
    <Thickness x:Key="BarItemThemeKey_InMenuClientPadding">0,3,0,3</Thickness>
    <Thickness x:Key="BarItemThemeKey_InMenuContentMargin">6,0,14,0</Thickness>
    <Thickness x:Key="BarItemThemeKey_InMenuKeyGestureMargin">6,0,14,0</Thickness>
    <Thickness x:Key="BarCheckItemThemeKey_BorderMarginInMenu">-2</Thickness>
   

    <Style x:Key="BarSubItemThemeKey_ArrowStyle" TargetType="dxb:BarSubItemArrowControl">
        <Setter Property="Template" Value="{StaticResource BarSubItemThemeKey_ArrowTemplate}" />       
        <Setter Property="HorizontalAlignment" Value="Stretch" />
        <Setter Property="VerticalAlignment" Value="Stretch" />
    </Style>

    <sys:Double x:Key="Double.NaN">NaN</sys:Double>
    <ControlTemplate x:Key="BarButtonItemThemeKey_Template" TargetType="dxb:BarButtonItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" Margin="{StaticResource BarItemThemeKey_Margin}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{TemplateBinding BorderTemplate}" ItemPosition="{Binding Path=(dxb:ItemPositionTypeProvider.HorizontalItemPosition), RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel Style="{TemplateBinding LayoutPanelStyle}" Alignment="{TemplateBinding ActualGlyphAlignment}">
                <dxc:Items2Panel.Content1>
                    <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                        <dxc:ImagePixelSnapper>
                            <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{TemplateBinding GlyphRenderTransform}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{TemplateBinding NormalContentStyle}" Visibility="{TemplateBinding ActualContentVisibility}" VerticalAlignment="Center">
                            
                        </ContentControl>
                    </dxc:MeasurePixelSnapper>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>
    <ControlTemplate x:Key="BarButtonItemThemeKey_InRibbonPageGroupTemplate" TargetType="dxb:BarButtonItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{TemplateBinding BorderTemplate}" ItemPosition="{Binding Path=(dxb:ItemPositionTypeProvider.HorizontalItemPosition), RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel Style="{TemplateBinding LayoutPanelStyle}" Alignment="{TemplateBinding ActualGlyphAlignment}">
                <dxc:Items2Panel.Content1>
                    <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" VerticalAlignment="Top">
                        <dxc:ImagePixelSnapper>
                            <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{TemplateBinding GlyphRenderTransform}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <dxc:MeasurePixelSnapper SnapperType="Around" VerticalAlignment="Stretch">
                        <Grid>
                            <Grid Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                                <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{TemplateBinding NormalContentStyle}" Visibility="{TemplateBinding ActualContentVisibility}">
                                    
                                </ContentControl>
                            </Grid>
                            <Grid Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" Margin="0,3,0,0">                               
                                <dxb:TextSplitterControl Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" IsSelected="{TemplateBinding IsMouseOver}" Style="{StaticResource BarButtonItemThemeKey_TextSplitterStyleInRibbonPageGroup}" NormalTextStyle="{StaticResource BarButtonItemThemeKey_NormalTextStyleInTextSplitter}" SelectedTextStyle="{StaticResource BarButtonItemThemeKey_SelectedTextStyleInTextSplitter}" Visibility="{TemplateBinding ActualContentVisibility}" SplitMethod="BySpace" IsArrowVisible="False" />
                            </Grid>
                        </Grid>
                    </dxc:MeasurePixelSnapper>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>
    <ControlTemplate x:Key="BarCheckItemThemeKey_Template" TargetType="dxb:BarCheckItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" Margin="{StaticResource BarItemThemeKey_Margin}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" ItemPosition="{Binding Path=(dxb:ItemPositionTypeProvider.HorizontalItemPosition), RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                        <dxc:ImagePixelSnapper>
                            <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}">
                            
                        </ContentControl>
                    </dxc:MeasurePixelSnapper>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ItemCheckState">
                    <VisualState x:Name="ItemChecked" />
                    <VisualState x:Name="ItemUnchecked" />
                    <VisualState x:Name="ItemIndeterminate" />
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarSplitButtonItemThemeKey_Template" TargetType="dxb:BarSplitButtonItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" Margin="{StaticResource BarItemThemeKey_Margin}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_CustomizationBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel x:Name="itemPanel" Style="{Binding Path=ContentAndArrowLayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" StretchedContent="Content2" Alignment="{Binding Path=ActualArrowAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <Grid Name="PART_ArrowButton">
                        <dxb:ItemBorderControl x:Name="PART_ArrowBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" ItemPosition="{TemplateBinding ArrowPartItemPosition}" />
                        <Border Background="Transparent">
                            <ContentControl x:Name="PART_ArrowContent" VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch">
                                <ContentControl.Content>
                                    <dxb:BarSplitButtonItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSplitButtonItemThemeKey_ArrowStyle}" />
                                </ContentControl.Content>
                            </ContentControl>
                        </Border>
                    </Grid>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <Grid>
                        <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" ItemPosition="{TemplateBinding ContentPartItemPosition}" />
                        <dxc:Items2Panel HorizontalAlignment="Center" Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                            <dxc:Items2Panel.Content1>
                                <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                                    <dxc:ImagePixelSnapper>
                                        <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </dxc:ImagePixelSnapper>
                                </Border>
                            </dxc:Items2Panel.Content1>
                            <dxc:Items2Panel.Content2>
                                <dxc:MeasurePixelSnapper SnapperType="Around">
                                    <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}">
                                        
                                    </ContentControl>
                                </dxc:MeasurePixelSnapper>
                            </dxc:Items2Panel.Content2>
                        </dxc:Items2Panel>
                    </Grid>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ArrowAlignment">
                    <VisualState x:Name="Bottom">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Bottom</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Top</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Right">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Right</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="NoArrow">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowButton" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="ArrowHot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="ArrowPressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarSubItemThemeKey_Template" TargetType="dxb:BarSubItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" Margin="{StaticResource BarItemThemeKey_Margin}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" ItemPosition="{Binding Path=(dxb:ItemPositionTypeProvider.HorizontalItemPosition), RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel StretchedContent="Content1" Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                            <dxc:ImagePixelSnapper>
                                <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                            </dxc:ImagePixelSnapper>
                        </Border>
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}" Margin="5,0,4,0">
                                
                            </ContentControl>
                        </dxc:MeasurePixelSnapper>
                    </StackPanel>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <StackPanel Orientation="Horizontal">
                        <Border x:Name="PART_ContentToArrowIndent" Width="{Binding Path=ContentToArrowIndent, RelativeSource={RelativeSource TemplatedParent}}" />
                        <ContentControl x:Name="PART_ArrowContent" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}">
                            <ContentControl.Content>
                                <dxb:BarSubItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSubItemThemeKey_ArrowStyle}" dxb:LinksControl.LinkContainerType="{Binding Path=(dxb:LinksControl.LinkContainerType), RelativeSource={RelativeSource TemplatedParent}}" />
                            </ContentControl.Content>
                        </ContentControl>
                    </StackPanel>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <dxb:PopupMenuBase x:Name="PART_Popup" />
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarEditItemThemeKey_Template" TargetType="dxb:BarEditItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" Margin="{StaticResource BarItemThemeKey_Margin}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" />
            <dxc:Items2Panel Style="{Binding Path=EditAndContentLayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="Left">
                <dxc:Items2Panel.Content1>
                    <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="Left">
                        <dxc:Items2Panel.Content1>
                            <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                                <dxc:ImagePixelSnapper>
                                    <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                                </dxc:ImagePixelSnapper>
                            </Border>
                        </dxc:Items2Panel.Content1>
                        <dxc:Items2Panel.Content2>
                            <dxc:MeasurePixelSnapper SnapperType="Around">
                                <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}" />
                            </dxc:MeasurePixelSnapper>
                        </dxc:Items2Panel.Content2>
                    </dxc:Items2Panel>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <dxc:MeasurePixelSnapper SnapperType="Around" HorizontalAlignment="{Binding Path=Link.ActualHorizontalEditAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                        <ContentControl x:Name="PART_EditContent" Width="{Binding Path=EditLink.ActualEditWidth, RelativeSource={RelativeSource TemplatedParent}}" Content="{Binding Path=Edit, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalEditStyle, RelativeSource={RelativeSource TemplatedParent}}" />
                    </dxc:MeasurePixelSnapper>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarStaticItemThemeKey_Template" TargetType="dxb:BarStaticItemLinkControl">
        <Grid x:Name="PART_Item" Margin="{StaticResource BarItemThemeKey_Margin}" MinWidth="{Binding Path=StaticItemLink.ActualMinWidth, RelativeSource={RelativeSource TemplatedParent}}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" IsHitTestVisible="False" />
            <Border Background="Transparent" Padding="1" MinHeight="22" IsHitTestVisible="False">
                <ContentControl x:Name="PART_Border" Template="{StaticResource BarStaticItemThemeKey_BorderTemplate}" DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}}" IsHitTestVisible="False" />
            </Border>
            <Border Padding="3,0,3,0">
                <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="{Binding Path=StaticItemLink.ContentAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                    <dxc:Items2Panel.Content1>
                        <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" IsHitTestVisible="False">
                            <dxc:ImagePixelSnapper>
                                <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                            </dxc:ImagePixelSnapper>
                        </Border>
                    </dxc:Items2Panel.Content1>
                    <dxc:Items2Panel.Content2>
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="{Binding Path=Link.Item.ContentAlignment, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}" IsHitTestVisible="True">
                                
                            </ContentControl>
                        </dxc:MeasurePixelSnapper>
                    </dxc:Items2Panel.Content2>
                </dxc:Items2Panel>
            </Border>
            
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="WidthState">
                    <VisualState x:Name="HasWidth">
                    </VisualState>
                    <VisualState x:Name="NoWidth">
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>


    <ControlTemplate x:Key="BarButtonItemThemeKey_InMenuTemplate" TargetType="dxb:BarButtonItemLinkControl">
        <Grid x:Name="PART_Item" Margin="1" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <Border Padding="{StaticResource BarItemThemeKey_InMenuClientPadding}" Background="Transparent">
                <dxb:ItemContentPanel>
                    <Border Margin="{Binding Path=(dxb:LinksControl.LinksControl).GlyphPadding, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" x:Name="PART_GlyphBorder" Height="Auto" Background="Transparent">
                        <dxc:ImagePixelSnapper>
                            <Image Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualGlyphVisibility}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                    <StackPanel x:Name="PART_ContentAndDescription" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}">
                        <ContentControl Name="PART_Content" VerticalAlignment="Center" HorizontalAlignment="Left" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}">
                            
                        </ContentControl>
                        <ContentControl Name="PART_Description" VerticalAlignment="Center" HorizontalAlignment="Left" Visibility="Collapsed" Content="{Binding Path=Link.ActualDescription, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalDescriptionStyle, RelativeSource={RelativeSource TemplatedParent}}" />
                    </StackPanel>
                        <ContentControl Name="PART_KeyGesture" dxb:ItemContentPanel.Alignment="Far" Margin="{StaticResource BarItemThemeKey_InMenuKeyGestureMargin}" Content="{Binding Path=Link.KeyGestureText, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="Collapsed" VerticalAlignment="Center" />
                </dxb:ItemContentPanel>
            </Border>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="KeyGestureVisibility">
                    <VisualState x:Name="KeyGestureVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_KeyGesture" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="DescriptionVisibility">
                    <VisualState x:Name="DescriptionVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Stretch</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="DescriptionHidden">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Center</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarCheckItemThemeKey_InMenuTemplate" TargetType="dxb:BarCheckItemLinkControl">
        <Grid x:Name="PART_Item" Margin="1" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <Border Padding="{StaticResource BarItemThemeKey_InMenuClientPadding}" Background="Transparent">
                <dxb:ItemContentPanel>
                    <Border Margin="{Binding Path=(dxb:LinksControl.LinksControl).GlyphPadding, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="Auto" Background="Transparent">
                        <Grid FlowDirection="LeftToRight">
                            <ContentControl x:Name="PART_TriStateGlyph" Opacity="0" VerticalAlignment="Center" HorizontalAlignment="Center" Template="{StaticResource BarCheckItemThemeKey_TriStateBorderInMenu}" />
                            <ContentControl x:Name="PART_CheckGlyph" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0" Template="{StaticResource BarCheckItemThemeKey_CheckInMenu}" />
                            <ContentControl x:Name="PART_GlyphCheckBorder" Margin="{StaticResource BarCheckItemThemeKey_BorderMarginInMenu}" Opacity="0" Template="{StaticResource BarCheckItemThemeKey_GlyphCheckBorderInMenu}" VerticalAlignment="Center">
                                <Border Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" />
                            </ContentControl>
                            <ContentControl x:Name="PART_GlyphTriStateBorder" Margin="{StaticResource BarCheckItemThemeKey_BorderMarginInMenu}" Opacity="0" Template="{StaticResource BarCheckItemThemeKey_GlyphTriStateBorderInMenu}" VerticalAlignment="Center">
                                <Border Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" />
                            </ContentControl>
                            <dxc:ImagePixelSnapper>
                                <Image Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualGlyphVisibility}" />
                            </dxc:ImagePixelSnapper>
                        </Grid>
                    </Border>
                    <StackPanel x:Name="PART_ContentAndDescription" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}">
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" VerticalAlignment="Center" HorizontalAlignment="Left">
                                
                            </ContentControl>
                        </dxc:MeasurePixelSnapper>
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl Name="PART_Description" VerticalAlignment="Center" HorizontalAlignment="Left" Visibility="Collapsed" Content="{Binding Path=Link.ActualDescription, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalDescriptionStyle, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxc:MeasurePixelSnapper>
                    </StackPanel>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl Name="PART_KeyGesture" dxb:ItemContentPanel.Alignment="Far" Margin="{StaticResource BarItemThemeKey_InMenuKeyGestureMargin}" Content="{Binding Path=Link.KeyGestureText, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="Collapsed" VerticalAlignment="Center" />
                    </dxc:MeasurePixelSnapper>
                </dxb:ItemContentPanel>
            </Border>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphCheckBorder" Storyboard.TargetProperty="Background">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <SolidColorBrush Color="#00FFFFFF" />
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphTriStateBorder" Storyboard.TargetProperty="Background">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <SolidColorBrush Color="#00FFFFFF" />
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Pressed">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphCheckBorder" Storyboard.TargetProperty="Background">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <SolidColorBrush Color="#00FFFFFF" />
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphTriStateBorder" Storyboard.TargetProperty="Background">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <SolidColorBrush Color="#00FFFFFF" />
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="KeyGestureVisibility">
                    <VisualState x:Name="KeyGestureVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_KeyGesture" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="DescriptionVisibility">
                    <VisualState x:Name="DescriptionVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Stretch</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="DescriptionHidden">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Center</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="TriStateBorderVisibility">
                    <VisualState x:Name="TriStateBorderVisible">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_TriStateGlyph" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="TriStateBorderHidden">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_TriStateGlyph" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="CheckVisibility">
                    <VisualState x:Name="CheckVisible">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_CheckGlyph" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="CheckHidden">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_CheckGlyph" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="TriStateGlyphBorderVisibility">
                    <VisualState x:Name="TriStateGlyphBorderVisible">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphTriStateBorder" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="TriStateGlyphBorderHidden">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphTriStateBorder" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="GlyphCheckVisibility">
                    <VisualState x:Name="GlyphCheckVisible">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphCheckBorder" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="GlyphCheckHidden">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_GlyphCheckBorder" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="0.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarStaticItemThemeKey_InMenuTemplate" TargetType="dxb:BarStaticItemLinkControl">
        <Grid x:Name="PART_Item" Margin="1" Background="Transparent" MinWidth="{Binding Path=StaticItemLink.ActualMinWidth, RelativeSource={RelativeSource TemplatedParent}}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <Border Padding="{StaticResource BarItemThemeKey_InMenuClientPadding}" Background="Transparent">
                <dxb:ItemContentPanel>
                    <Border Margin="{Binding Path=(dxb:LinksControl.LinksControl).GlyphPadding, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" x:Name="PART_GlyphBorder" Height="Auto" Background="Transparent">
                        <dxc:ImagePixelSnapper>
                            <Image Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualGlyphVisibility}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                    <StackPanel x:Name="PART_ContentAndDescription" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}">
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl Name="PART_Content" VerticalAlignment="Center" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="{Binding Path=Link.Item.ContentAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                                
                            </ContentControl>
                        </dxc:MeasurePixelSnapper>
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl Name="PART_Description" VerticalAlignment="Center" HorizontalAlignment="Left" Visibility="Collapsed" Content="{Binding Path=Link.ActualDescription, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalDescriptionStyle, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxc:MeasurePixelSnapper>
                    </StackPanel>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl Name="PART_KeyGesture" dxb:ItemContentPanel.Alignment="Far" Margin="{StaticResource BarItemThemeKey_InMenuKeyGestureMargin}" Content="{Binding Path=Link.KeyGestureText, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="Collapsed" VerticalAlignment="Center" />
                    </dxc:MeasurePixelSnapper>
                </dxb:ItemContentPanel>
            </Border>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="KeyGestureVisibility">
                    <VisualState x:Name="KeyGestureVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_KeyGesture" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="DescriptionVisibility">
                    <VisualState x:Name="DescriptionVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Stretch</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="DescriptionHidden">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Center</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="WidthState">
                    <VisualState x:Name="HasWidth">
                    </VisualState>
                    <VisualState x:Name="NoWidth">
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarSubItemThemeKey_InMenuTemplate" TargetType="dxb:BarSubItemLinkControl">
        <Grid x:Name="PART_Item" Margin="1" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <Border Padding="{StaticResource BarItemThemeKey_InMenuClientPadding}" Background="Transparent">
                <dxb:ItemContentPanel>
                    <Border Margin="{Binding Path=(dxb:LinksControl.LinksControl).GlyphPadding, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="Auto" Background="Transparent">
                        <dxc:ImagePixelSnapper>
                            <Image Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualGlyphVisibility}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                    <StackPanel x:Name="PART_ContentAndDescription" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}">
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl Name="PART_Content" VerticalAlignment="Center" HorizontalAlignment="Left" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}">
                                
                            </ContentControl>
                        </dxc:MeasurePixelSnapper>
                        <dxc:MeasurePixelSnapper SnapperType="Around">
                            <ContentControl Name="PART_Description" VerticalAlignment="Center" HorizontalAlignment="Left" Visibility="Collapsed" Content="{Binding Path=Link.ActualDescription, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalDescriptionStyle, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxc:MeasurePixelSnapper>
                    </StackPanel>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl Name="PART_KeyGesture" dxb:ItemContentPanel.Alignment="Far" Margin="{StaticResource BarItemThemeKey_InMenuKeyGestureMargin}" Content="{Binding Path=Link.KeyGestureText, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="Collapsed" VerticalAlignment="Center" />
                    </dxc:MeasurePixelSnapper>
                    <ContentControl Name="PART_ArrowContent" dxb:ItemContentPanel.Alignment="Far" Margin="0,0,2,0" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <ContentControl.Content>
                            <dxb:BarSubItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSubItemThemeKey_ArrowStyle}" dxb:LinksControl.LinkContainerType="{Binding Path=(dxb:LinksControl.LinkContainerType), RelativeSource={RelativeSource TemplatedParent}}" Visibility="Visible" />
                        </ContentControl.Content>
                    </ContentControl>
                </dxb:ItemContentPanel>
            </Border>
            <ContentControl Height="0" Width="0"> 
              <dxb:PopupMenuBase x:Name="PART_Popup" DefaultVerticalOffset="-1" />
            </ContentControl> 
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="KeyGestureVisibility">
                    <VisualState x:Name="KeyGestureVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_KeyGesture" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="DescriptionVisibility">
                    <VisualState x:Name="DescriptionVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Stretch</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="DescriptionHidden">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Center</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarSplitButtonItemThemeKey_InMenuTemplate" TargetType="dxb:BarSplitButtonItemLinkControl">
        <Grid Margin="1" x:Name="PART_Item" Background="#00FFFFFF" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ControlBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" Visibility="{Binding Path=SplitButtonLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
            <dxb:ItemBorderControl Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" x:Name="PART_CustomizationBorder" />
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid HorizontalAlignment="Stretch" Width="Auto" Margin="0,0,0,0">
                    <dxb:ItemBorderControl x:Name="PART_ItemBorder" Visibility="{Binding Path=SplitButtonLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" />
                    <Border Background="#00FFFFFF" Padding="{StaticResource BarItemThemeKey_InMenuClientPadding}">
                        <dxb:ItemContentPanel>
                            <Border Margin="{Binding Path=(dxb:LinksControl.LinksControl).GlyphPadding, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="Auto" Background="Transparent">
                                <dxc:ImagePixelSnapper>
                                    <Image Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualGlyphVisibility}" />
                                </dxc:ImagePixelSnapper>
                            </Border>
                            <StackPanel x:Name="PART_ContentAndDescription" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}">
                                <dxc:MeasurePixelSnapper SnapperType="Around">
                                    <ContentControl Name="PART_Content" VerticalAlignment="Center" HorizontalAlignment="Left" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}">
                                        
                                    </ContentControl>
                                </dxc:MeasurePixelSnapper>
                                <dxc:MeasurePixelSnapper SnapperType="Around">
                                    <ContentControl Name="PART_Description" VerticalAlignment="Center" HorizontalAlignment="Left" Visibility="Collapsed" Content="{Binding Path=Link.ActualDescription, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalDescriptionStyle, RelativeSource={RelativeSource TemplatedParent}}" />
                                </dxc:MeasurePixelSnapper>
                            </StackPanel>
                            <dxc:MeasurePixelSnapper SnapperType="Around">
                                <ContentControl Name="PART_KeyGesture" dxb:ItemContentPanel.Alignment="Far" Margin="{StaticResource BarItemThemeKey_InMenuKeyGestureMargin}" Content="{Binding Path=Link.KeyGestureText, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="Collapsed" VerticalAlignment="Center" />
                            </dxc:MeasurePixelSnapper>
                        </dxb:ItemContentPanel>
                    </Border>
                </Grid>
                <Grid HorizontalAlignment="Right" Margin="0,0,0,0" x:Name="PART_ArrowButton" Grid.Column="1">
                    <dxb:ItemBorderControl x:Name="PART_ArrowBorder" Visibility="{Binding Path=SplitButtonLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" />
                    <ContentControl x:Name="PART_ArrowContent" HorizontalContentAlignment="Center" VerticalContentAlignment="Center">
                        <ContentControl.Content>
                            <dxb:BarSplitButtonItemArrowControl x:Name="PART_ArrowControl" Visibility="Visible" />
                        </ContentControl.Content>
                    </ContentControl>
                </Grid>
            </Grid>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="KeyGestureVisibility">
                    <VisualState x:Name="KeyGestureVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_KeyGesture" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="DescriptionVisibility">
                    <VisualState x:Name="DescriptionVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Stretch</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="DescriptionHidden">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Center</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ArrowAlignment">
                    <VisualState x:Name="Right">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Right</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="NoArrow">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowButton" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <Thickness x:Key="BarEditItemThemeKey_InMenuClientPadding">0</Thickness>

    <ControlTemplate x:Key="BarEditItemThemeKey_InMenuTemplate" TargetType="dxb:BarEditItemLinkControl">
        <Grid x:Name="PART_Item" Margin="1" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <Border Padding="{StaticResource BarEditItemThemeKey_InMenuClientPadding}" Background="Transparent">
                <dxb:ItemContentPanel>
                    <Border Margin="{Binding Path=(dxb:LinksControl.LinksControl).GlyphPadding, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" x:Name="PART_GlyphBorder" Height="Auto" Background="Transparent">
                        <dxc:ImagePixelSnapper>
                            <Image Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualGlyphVisibility}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}" />
                    </dxc:MeasurePixelSnapper>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl x:Name="PART_EditContent" Style="{Binding Path=NormalEditStyle, RelativeSource={RelativeSource TemplatedParent}}" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}" Content="{Binding Path=Edit, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=EditLink.ActualEditWidth, RelativeSource={RelativeSource TemplatedParent}}" />
                    </dxc:MeasurePixelSnapper>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <ContentControl Name="PART_KeyGesture" dxb:ItemContentPanel.Alignment="Far" Margin="{StaticResource BarItemThemeKey_InMenuKeyGestureMargin}" Content="{Binding Path=Link.KeyGestureText, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="Collapsed" VerticalAlignment="Center" />
                    </dxc:MeasurePixelSnapper>
                </dxb:ItemContentPanel>
            </Border>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="KeyGestureVisibility">
                    <VisualState x:Name="KeyGestureVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_KeyGesture" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarSplitButtonItemThemeKey_InPageGroupTemplate" TargetType="dxb:BarSplitButtonItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ControlBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" Visibility="{Binding Path=SplitButtonLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
            <dxb:ItemBorderControl x:Name="PART_CustomizationBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel x:Name="itemPanel" FillContent1="True" Style="{Binding Path=ContentAndArrowLayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualArrowAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <Grid Name="PART_ArrowButton" Grid.Row="1" Background="Transparent">
                        <Grid Visibility="{Binding Path=SplitButtonLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                            <dxb:ItemBorderControl x:Name="PART_ArrowBorder" Template="{StaticResource BarSplitButtonItemThemeKey_ArrowBorderTemplateInRibbonPageGroup}" HideBorderSide="None" IsHitTestVisible="False" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" />
                            <dxb:ItemBorderControl x:Name="PART_LargeArrowBorder" IsActive="{TemplateBinding IsArrowBorderActive}" State="{TemplateBinding ArrowBorderState}" Template="{StaticResource BarSplitButtonItemThemeKey_LargeArrowBorderTemplateInRibbonPageGroup}" HideBorderSide="None" IsHitTestVisible="False" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
                        </Grid>
                        <Border Background="Transparent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Visibility="{Binding Path=ShowContentInArrow, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                            <ContentControl x:Name="PART_ArrowContent" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
                                <ContentControl.Content>
                                    <dxb:BarSplitButtonItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSplitButtonItemThemeKey_ArrowStyle}" Template="{StaticResource BarSplitButtonItemThemeKey_ArrowTemplateInRibbonPageGroup}" Visibility="Visible" />
                                </ContentControl.Content>
                            </ContentControl>
                        </Border>
                        <dxc:MeasurePixelSnapper x:Name="PART_ContentInArrow" HorizontalAlignment="Center" SnapperType="Around" Visibility="{Binding Path=ShowContentInArrow, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}">
                            <dxb:TextSplitterControl Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" IsSelected="{TemplateBinding IsMouseOver}" Style="{StaticResource BarSplitButtonItemThemeKey_TextSplitterStyleInRibbonPageGroup}" NormalArrowTemplate="{StaticResource BarSplitButtonItemThemeKey_NormalArrowTemplateInTextSplitter}" SelectedArrowTemplate="{StaticResource BarSplitButtonItemThemeKey_SelectedArrowTemplateInTextSplitter}" NormalTextStyle="{StaticResource BarSplitButtonItemThemeKey_NormalTextStyleInTextSplitter}" SelectedTextStyle="{StaticResource BarSplitButtonItemThemeKey_SelectedTextStyleInTextSplitter}" BottomSideArrowContainerStyle="{StaticResource BarSplitButtonItemThemeKey_BottomSideArrowContainerStyleInTextSplitter}" RightSideArrowContainerStyle="{StaticResource BarSplitButtonItemThemeKey_RightSideArrowContainerStyleInTextSplitter}" Visibility="{TemplateBinding ActualContentVisibility}" SplitMethod="BySpace" IsArrowVisible="True" />
                        </dxc:MeasurePixelSnapper>
                    </Grid>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <Grid>
                        <Grid Visibility="{Binding Path=SplitButtonLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{StaticResource BarSplitButtonItemThemeKey_ContentBorderTemplateInRibbonPageGroup}" HideBorderSide="None" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" />
                            <dxb:ItemBorderControl x:Name="PART_LargeItemBorder" Template="{StaticResource BarSplitButtonItemThemeKey_LargeContentBorderTemplateInRibbonPageGroup}" IsActive="{TemplateBinding IsContentBorderActive}" State="{TemplateBinding ContentBorderState}" HideBorderSide="None" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
                        </Grid>
                        <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                            <dxc:Items2Panel.Content1>
                                <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                                    <dxc:ImagePixelSnapper>
                                        <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </dxc:ImagePixelSnapper>
                                </Border>
                            </dxc:Items2Panel.Content1>
                            <dxc:Items2Panel.Content2>
                                <dxc:MeasurePixelSnapper SnapperType="Around" Visibility="{Binding Path=ShowContentInArrow, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                                    <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}">
                                        
                                    </ContentControl>
                                </dxc:MeasurePixelSnapper>
                            </dxc:Items2Panel.Content2>
                        </dxc:Items2Panel>
                    </Grid>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ArrowAlignment">
                    <VisualState x:Name="Bottom">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Bottom</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Top</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_LargeArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Top</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_LargeItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Bottom</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Right">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Right</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="NoArrow">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowButton" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="ArrowHot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="ArrowPressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="BarSubItemThemeKey_InRibbonPageGroupTemplate" TargetType="dxb:BarSubItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" ItemPosition="{Binding Path=(dxb:ItemPositionTypeProvider.HorizontalItemPosition), RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" VerticalAlignment="Top">
                        <dxc:ImagePixelSnapper>
                            <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <Grid>
                        <Grid Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <dxc:MeasurePixelSnapper SnapperType="Around">
                                <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}">
                                    
                                </ContentControl>
                            </dxc:MeasurePixelSnapper>
                            <Border Grid.Column="1" x:Name="PART_ContentToArrowIndent" Width="{Binding Path=ContentToArrowIndent, RelativeSource={RelativeSource TemplatedParent}}" />
                            <ContentControl Grid.Column="2" x:Name="PART_ArrowContent" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}">
                                <ContentControl.Content>
                                    <dxb:BarSubItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSubItemThemeKey_ArrowStyle}" dxb:LinksControl.LinkContainerType="{Binding Path=(dxb:LinksControl.LinkContainerType), RelativeSource={RelativeSource TemplatedParent}}" Visibility="Visible" />
                                </ContentControl.Content>
                            </ContentControl>
                        </Grid>
                        <Grid Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}">
                            <dxb:TextSplitterControl Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" IsSelected="{TemplateBinding IsMouseOver}" Style="{StaticResource BarSubItemThemeKey_TextSplitterStyleInRibbonPageGroup}" NormalArrowTemplate="{StaticResource BarSubItemThemeKey_NormalArrowTemplateInTextSplitter}" SelectedArrowTemplate="{StaticResource BarSubItemThemeKey_SelectedArrowTemplateInTextSplitter}" NormalTextStyle="{StaticResource BarSubItemThemeKey_NormalTextStyleInTextSplitter}" SelectedTextStyle="{StaticResource BarSubItemThemeKey_SelectedTextStyleInTextSplitter}" BottomSideArrowContainerStyle="{StaticResource BarSubItemThemeKey_BottomSideArrowContainerStyleInTextSplitter}" RightSideArrowContainerStyle="{StaticResource BarSubItemThemeKey_RightSideArrowContainerStyleInTextSplitter}" Visibility="{TemplateBinding ActualContentVisibility}" SplitMethod="BySpace" IsArrowVisible="True" />
                        </Grid>
                    </Grid>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>            
            <dxb:PopupMenuBase x:Name="PART_Popup" />
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot">

                    </VisualState>
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>
    <ControlTemplate x:Key="BarCheckItemThemeKey_InRibbonPageGroupTemplate" TargetType="dxb:BarCheckItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" ItemPosition="{Binding Path=(dxb:ItemPositionTypeProvider.HorizontalItemPosition), RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" VerticalAlignment="Top">
                        <dxc:ImagePixelSnapper>
                            <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                        </dxc:ImagePixelSnapper>
                    </Border>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <dxc:MeasurePixelSnapper SnapperType="Around">
                        <Grid>
                            <Grid Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                                <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}">
                                    
                                </ContentControl>
                            </Grid>
                            <Grid Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}">
                                <dxb:TextSplitterControl Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" IsSelected="{TemplateBinding IsMouseOver}" Style="{StaticResource BarCheckItemThemeKey_TextSplitterStyleInRibbonPageGroup}" NormalTextStyle="{StaticResource BarCheckItemThemeKey_NormalTextStyleInTextSplitter}" SelectedTextStyle="{StaticResource BarCheckItemThemeKey_SelectedTextStyleInTextSplitter}" Visibility="{TemplateBinding ActualContentVisibility}" SplitMethod="BySpace" IsArrowVisible="False" />
                            </Grid>
                        </Grid>
                    </dxc:MeasurePixelSnapper>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ItemCheckState">
                    <VisualState x:Name="ItemChecked" />
                    <VisualState x:Name="ItemUnchecked" />
                    <VisualState x:Name="ItemIndeterminate" />
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>
    
    <dxc:BoolToDoubleConverter TrueValue="1.0" x:Key="booleanToOpacityConverter" />
    <ControlTemplate x:Key="BarSplitCheckItemThemeKey_InPageGroupTemplate" TargetType="dxb:BarSplitCheckItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ControlBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" Visibility="{Binding Path=SplitCheckLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
            <dxb:ItemBorderControl x:Name="PART_CustomizationBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel x:Name="itemPanel" FillContent1="True" Style="{Binding Path=ContentAndArrowLayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualArrowAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <Grid Name="PART_ArrowButton" Grid.Row="1" Background="Transparent">
                        <Grid Visibility="{Binding Path=SplitCheckLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                            <dxb:ItemBorderControl x:Name="PART_ArrowBorder" Template="{StaticResource BarSplitButtonItemThemeKey_ArrowBorderTemplateInRibbonPageGroup}" HideBorderSide="None" IsHitTestVisible="False" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" />
                            <dxb:ItemBorderControl x:Name="PART_LargeArrowBorder" IsActive="{TemplateBinding IsArrowBorderActive}" State="{TemplateBinding ArrowBorderState}" Template="{StaticResource BarSplitButtonItemThemeKey_LargeArrowBorderTemplateInRibbonPageGroup}" HideBorderSide="None" IsHitTestVisible="False" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
                        </Grid>
                        <Border Background="Transparent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Visibility="{Binding Path=ShowContentInArrow, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                            <ContentControl x:Name="PART_ArrowContent" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
                                <ContentControl.Content>
                                    <dxb:BarSplitButtonItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSplitButtonItemThemeKey_ArrowStyle}" Template="{StaticResource BarSplitButtonItemThemeKey_ArrowTemplateInRibbonPageGroup}" Visibility="Visible" />
                                </ContentControl.Content>
                            </ContentControl>
                        </Border>
                        <dxc:MeasurePixelSnapper x:Name="PART_ContentInArrow" HorizontalAlignment="Center" SnapperType="Around" Visibility="{Binding Path=ShowContentInArrow, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}">
                            <dxb:TextSplitterControl Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" IsSelected="{TemplateBinding IsMouseOver}" Style="{StaticResource BarSplitButtonItemThemeKey_TextSplitterStyleInRibbonPageGroup}" NormalArrowTemplate="{StaticResource BarSplitButtonItemThemeKey_NormalArrowTemplateInTextSplitter}" SelectedArrowTemplate="{StaticResource BarSplitButtonItemThemeKey_SelectedArrowTemplateInTextSplitter}" NormalTextStyle="{StaticResource BarSplitButtonItemThemeKey_NormalTextStyleInTextSplitter}" SelectedTextStyle="{StaticResource BarSplitButtonItemThemeKey_SelectedTextStyleInTextSplitter}" BottomSideArrowContainerStyle="{StaticResource BarSplitButtonItemThemeKey_BottomSideArrowContainerStyleInTextSplitter}" RightSideArrowContainerStyle="{StaticResource BarSplitButtonItemThemeKey_RightSideArrowContainerStyleInTextSplitter}" Visibility="{TemplateBinding ActualContentVisibility}" SplitMethod="BySpace" IsArrowVisible="True" />
                        </dxc:MeasurePixelSnapper>
                    </Grid>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <Grid>
                        <Grid Visibility="{Binding Path=SplitCheckLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                            <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{StaticResource BarSplitButtonItemThemeKey_ContentBorderTemplateInRibbonPageGroup}" HideBorderSide="None" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" />
                            <dxb:ItemBorderControl x:Name="PART_LargeItemBorder" Template="{StaticResource BarSplitButtonItemThemeKey_LargeContentBorderTemplateInRibbonPageGroup}" IsActive="{TemplateBinding IsContentBorderActive}" State="{TemplateBinding ContentBorderState}" HideBorderSide="None" Visibility="{Binding Path=IsRibbonStyleLarge, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
                        </Grid>
                        <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                            <dxc:Items2Panel.Content1>
                                <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                                    <dxc:ImagePixelSnapper>
                                        <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </dxc:ImagePixelSnapper>
                                </Border>
                            </dxc:Items2Panel.Content1>
                            <dxc:Items2Panel.Content2>
                                <dxc:MeasurePixelSnapper SnapperType="Around" Visibility="{Binding Path=ShowContentInArrow, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}">
                                    <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}">
                                        
                                    </ContentControl>
                                </dxc:MeasurePixelSnapper>
                            </dxc:Items2Panel.Content2>
                        </dxc:Items2Panel>
                    </Grid>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>

            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ArrowAlignment">
                    <VisualState x:Name="Bottom">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Bottom</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Top</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_LargeArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Top</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_LargeItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Bottom</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Right">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Right</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="NoArrow">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowButton" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="ArrowHot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="ArrowPressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>
    <ControlTemplate x:Key="BarSplitCheckItemThemeKey_InMenuTemplate" TargetType="dxb:BarSplitCheckItemLinkControl">
        <Grid Margin="1" x:Name="PART_Item" Background="#00FFFFFF" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_ControlBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" Visibility="{Binding Path=SplitCheckLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource notInvertedBooleanToVisibilityConverter}}" />
            <dxb:ItemBorderControl Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" x:Name="PART_CustomizationBorder" />
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid HorizontalAlignment="Stretch" Width="Auto" Margin="0,0,0,0">
                    <dxb:ItemBorderControl x:Name="PART_ItemBorder" Visibility="{Binding Path=SplitCheckLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" />
                    <Border Background="#00FFFFFF" Padding="{StaticResource BarItemThemeKey_InMenuClientPadding}">
                        <dxb:ItemContentPanel>
                            <Border Margin="{Binding Path=(dxb:LinksControl.LinksControl).GlyphPadding, RelativeSource={RelativeSource TemplatedParent}}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="Auto" Background="Transparent">
                                <Grid>
                                    <ContentControl x:Name="PART_TriStateGlyph" Opacity="0" VerticalAlignment="Center" HorizontalAlignment="Center" Template="{StaticResource BarCheckItemThemeKey_TriStateBorderInMenu}" />
                                    <ContentControl x:Name="PART_CheckGlyph" HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0" Template="{StaticResource BarCheckItemThemeKey_CheckInMenu}" />
                                    <ContentControl x:Name="PART_GlyphCheckBorder" Opacity="0" Margin="{StaticResource BarCheckItemThemeKey_BorderMarginInMenu}" Template="{StaticResource BarCheckItemThemeKey_GlyphCheckBorderInMenu}" VerticalAlignment="Center">
                                        <Border Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </ContentControl>
                                    <ContentControl x:Name="PART_GlyphTriStateBorder" Opacity="0" Margin="{StaticResource BarCheckItemThemeKey_BorderMarginInMenu}" Template="{StaticResource BarCheckItemThemeKey_GlyphTriStateBorderInMenu}" VerticalAlignment="Center">
                                        <Border Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </ContentControl>
                                    <dxc:ImagePixelSnapper>
                                        <Image Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualGlyphVisibility}" />
                                    </dxc:ImagePixelSnapper>
                                </Grid>
                            </Border>
                            <StackPanel x:Name="PART_ContentAndDescription" Margin="{StaticResource BarItemThemeKey_InMenuContentMargin}">
                                <dxc:MeasurePixelSnapper SnapperType="Around">
                                    <ContentControl Name="PART_Content" VerticalAlignment="Center" HorizontalAlignment="Left" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}">
                                        
                                    </ContentControl>
                                </dxc:MeasurePixelSnapper>
                                <dxc:MeasurePixelSnapper SnapperType="Around">
                                    <ContentControl Name="PART_Description" VerticalAlignment="Center" HorizontalAlignment="Left" Visibility="Collapsed" Content="{Binding Path=Link.ActualDescription, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalDescriptionStyle, RelativeSource={RelativeSource TemplatedParent}}" />
                                </dxc:MeasurePixelSnapper>
                            </StackPanel>
                            <dxc:MeasurePixelSnapper SnapperType="Around">
                                <ContentControl Name="PART_KeyGesture" dxb:ItemContentPanel.Alignment="Far" Margin="{StaticResource BarItemThemeKey_InMenuKeyGestureMargin}" Content="{Binding Path=Link.KeyGestureText, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="Collapsed" VerticalAlignment="Center" />
                            </dxc:MeasurePixelSnapper>
                        </dxb:ItemContentPanel>
                    </Border>
                </Grid>
                <Grid HorizontalAlignment="Right" Margin="0,0,0,0" x:Name="PART_ArrowButton" Grid.Column="1">
                    <dxb:ItemBorderControl x:Name="PART_ArrowBorder" Visibility="{Binding Path=SplitCheckLink.ActAsDropDown, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource invertedBooleanToVisibilityConverter}}" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" />
                    <ContentControl x:Name="PART_ArrowContent" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}">
                        <ContentControl.Content>
                            <dxb:BarSplitButtonItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSplitButtonItemThemeKey_ArrowStyle}" Visibility="Visible" />
                        </ContentControl.Content>
                    </ContentControl>
                </Grid>
            </Grid>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="KeyGestureVisibility">
                    <VisualState x:Name="KeyGestureVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_KeyGesture" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="DescriptionVisibility">
                    <VisualState x:Name="DescriptionVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Visible</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Stretch</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="DescriptionHidden">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_Description" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ContentAndDescription" Storyboard.TargetProperty="VerticalAlignment">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <VerticalAlignment>Center</VerticalAlignment>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ArrowAlignment">
                    <VisualState x:Name="Right">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Right</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="NoArrow">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowButton" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>
    <ControlTemplate x:Key="BarSplitCheckItemThemeKey_Template" TargetType="dxb:BarSplitCheckItemLinkControl">
        <Grid x:Name="PART_Item" Background="Transparent" Margin="{StaticResource BarItemThemeKey_Margin}" UseLayoutRounding="True">
            <dxb:ItemBorderControl x:Name="PART_CustomizationBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" />
            <dxc:Items2Panel x:Name="itemPanel" Style="{Binding Path=ContentAndArrowLayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualArrowAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                <dxc:Items2Panel.Content1>
                    <Grid Name="PART_ArrowButton">
                        <dxb:ItemBorderControl x:Name="PART_ArrowBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" ItemPosition="{TemplateBinding ArrowPartItemPosition}" />
                        <Border Background="Transparent" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <ContentControl x:Name="PART_ArrowContent" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch">
                                <ContentControl.Content>
                                    <dxb:BarSplitButtonItemArrowControl x:Name="PART_ArrowControl" Style="{StaticResource BarSplitButtonItemThemeKey_ArrowStyle}" Visibility="Visible" />
                                </ContentControl.Content>
                            </ContentControl>
                        </Border>
                    </Grid>
                </dxc:Items2Panel.Content1>
                <dxc:Items2Panel.Content2>
                    <Grid>
                        <dxb:ItemBorderControl x:Name="PART_ItemBorder" Template="{Binding Path=BorderTemplate, RelativeSource={RelativeSource TemplatedParent}}" HideBorderSide="None" ItemPosition="{TemplateBinding ContentPartItemPosition}" />
                        <dxc:Items2Panel Style="{Binding Path=LayoutPanelStyle, RelativeSource={RelativeSource TemplatedParent}}" Alignment="{Binding Path=ActualGlyphAlignment, RelativeSource={RelativeSource TemplatedParent}}">
                            <dxc:Items2Panel.Content1>
                                <Border x:Name="PART_GlyphBorder" Visibility="{TemplateBinding ActualGlyphVisibility}" Width="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Width, RelativeSource={RelativeSource TemplatedParent}}" Height="{Binding Path=(dxb:LinksControl.LinksControl).MaxGlyphSize.Height, RelativeSource={RelativeSource TemplatedParent}}">
                                    <dxc:ImagePixelSnapper>
                                        <Image x:Name="PART_Glyph" VerticalAlignment="Center" HorizontalAlignment="Center" MinWidth="16" MinHeight="16" Source="{Binding Path=ActualGlyph, RelativeSource={RelativeSource TemplatedParent}}" Stretch="None" RenderTransform="{Binding Path=GlyphRenderTransform, RelativeSource={RelativeSource TemplatedParent}}" />
                                    </dxc:ImagePixelSnapper>
                                </Border>
                            </dxc:Items2Panel.Content1>
                            <dxc:Items2Panel.Content2>
                                <dxc:MeasurePixelSnapper SnapperType="Around">
                                    <ContentControl x:Name="PART_Content" Content="{Binding Path=Link.ActualContent, RelativeSource={RelativeSource TemplatedParent}}" ContentTemplate="{Binding Path=Link.ActualContentTemplate, RelativeSource={RelativeSource TemplatedParent}}" Style="{Binding Path=NormalContentStyle, RelativeSource={RelativeSource TemplatedParent}}" Visibility="{TemplateBinding ActualContentVisibility}">
                                        
                                    </ContentControl>
                                </dxc:MeasurePixelSnapper>
                            </dxc:Items2Panel.Content2>
                        </dxc:Items2Panel>
                    </Grid>
                </dxc:Items2Panel.Content2>
            </dxc:Items2Panel>
            <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="ArrowAlignment">
                    <VisualState x:Name="Bottom">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Bottom</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Top</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Right">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Right</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>Left</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="NoArrow">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ItemBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowBorder" Storyboard.TargetProperty="HideBorderSide">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <dxb:HideBorderSide>None</dxb:HideBorderSide>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PART_ArrowButton" Storyboard.TargetProperty="Visibility">
                                <DiscreteObjectKeyFrame KeyTime="0:0:0">
                                    <DiscreteObjectKeyFrame.Value>
                                        <Visibility>Collapsed</Visibility>
                                    </DiscreteObjectKeyFrame.Value>
                                </DiscreteObjectKeyFrame>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="ItemState">
                    <VisualState x:Name="Normal">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="1.0" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                    <VisualState x:Name="Hot" />
                    <VisualState x:Name="ArrowHot" />
                    <VisualState x:Name="Pressed" />
                    <VisualState x:Name="ArrowPressed" />
                    <VisualState x:Name="Customization" />
                    <VisualState x:Name="Disabled">
                        <Storyboard>
                            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PART_Item" Storyboard.TargetProperty="Opacity">
                                <DiscreteDoubleKeyFrame KeyTime="0:0:0" Value="{StaticResource BarItemThemeKey_DisableStateOpacityValue}" />
                            </DoubleAnimationUsingKeyFrames>
                        </Storyboard>
                    </VisualState>
                </VisualStateGroup>
            </VisualStateManager.VisualStateGroups>
        </Grid>
    </ControlTemplate>
</ResourceDictionary>